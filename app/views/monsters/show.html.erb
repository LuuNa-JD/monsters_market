<div class="container mt-5">
  <div class="row">
    <div class="col-md-6">

      <img class="monster-image img-fluid"
        src="<%= cl_image_path @monster.photo.key, width: 1000, height: 600, crop: :pad %>" alt="Monster Image">
    </div>
    <div class="col-md-6">
      <div class="d-flex flex-column justify-content-end h-100">
        <h1 class="monster-title fw-bolder"><%= @monster.name %></h1>
        <p class="monster-description fw-bold"><%= @monster.description %></p>

        <p class="monster-price fw-bold">Prix: <%= @monster.price %>$ par semaine</p>
        <div class="book-button mt-3">
          <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#emailModal">Réservation</button>
        </div>
          <div class="btn-group mt-2 pt-1" style="margin-left: 30px;" role="group" aria-label="Actions">
            <% if current_user == @monster.user %>
                <%= link_to 'Edit', edit_monster_path(@monster), class: 'btn btn-primary custom-button' %>
                <%= button_to 'Supprimer', monster_path(@monster), method: :delete, data: { confirm: 'Êtes-vous sûr?' }, class: "btn btn-danger custom-button" %>
                <%= link_to 'Retour', monsters_path, class: "btn btn-secondary custom-button" %>
            <% else %>
                <div class="d-grid gap-2 d-md-block">
                  <%= link_to 'Retour', monsters_path, class: "btn btn-secondary custom-button" %>
                </div>

            <% end %>

          </div>

        <h2 class="monster-reviews-title fw-bold">Commentaires</h2>
        <% if @monster.review_text.present? %>
          <p class="monster-review-text fw-bold">Review: <%= @monster.review_text %></p>
        <% else %>
          <p class="no-reviews-message">Pas encore de commentaires.</p>

        <% end %>
        </div>
      </div>
    </div>
  </div>
</div>


<%= render 'email_modal' %>

<div data-controller="review" class="container mt-3">
  <div class="row">
    <div class="col-md-6">
      <button class="btn btn-add-review" id="show-review-form" data-action="click->review#toggle">Ajouter un commentaire</button>
    </div>
    <div data-review-target="AddReview" class="review-form col-md-6 d-none">
      <%= form_for @monster, url: custom_create_review_monster_path(@monster), method: :post, class: "needs-validation" do |f| %>
        <%= f.hidden_field :monster_id, value: @monster.id %>

        <div class="form-group">
          <%= f.label :rating, "Note (/5)", class: "form-label rating-label" %>
          <%= f.number_field :rating, class: "form-control small-input", min: 1, max: 5 %>
        </div>

        <div class="form-group">
          <%= f.label :review_text, "Commentaire", class: "form-label" %>
          <%= f.text_area :review_text, class: "form-control", rows: 4 %>
        </div>

        <%= f.submit "Valider le commentaire", class: "btn submit-button", data: { turbo_confirm: 'Are you sure?' } %>
      <% end %>
    </div>
  </div>
</div>
